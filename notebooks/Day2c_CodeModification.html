
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial 2c - Code Modifications (Workflow + Simulation) &#8212; CTSM Mini-tutorial 2022</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial 2d - Code Modifications (Visualization)" href="Day2d_CodeModification_Visualization.html" />
    <link rel="prev" title="Tutorial 2b: Single-Point Visualizations" href="Day2b_GenericSinglePoint_Visualization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/ncar_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CTSM Mini-tutorial 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Day0a_GitStarted.html">
   Tutorial 0a:
   <em>
    CTSM, CESM-Lab, &amp; Git
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Day0b_NEON_Simulation_Tutorial.html">
   Tutorial 0b:
   <em>
    CTSM Simulations at NEON Tower Sites
   </em>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Global Simulation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Day1a_GlobalCase.html">
   Tutorial 1a:
   <em>
    Global Simulations
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Day1b_GlobalVisualization.html">
   Tutorial 1b:
   <em>
    Global Visualizations
   </em>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Generic Single Point Simulation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Day2a_GenericSinglePoint.html">
   Tutorial 2a:
   <em>
    Running a generic single-point case
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Day2b_GenericSinglePoint_Visualization.html">
   Tutorial 2b:
   <em>
    Single-Point Visualizations
   </em>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Code Modification
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Tutorial 2c -
   <em>
    Code Modifications (Workflow + Simulation)
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Day2d_CodeModification_Visualization.html">
   Tutorial 2d -
   <em>
    Code Modifications (Visualization)
   </em>
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/Day2c_CodeModification.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/NCAR/CTSM-Tutorial-2022"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/NCAR/CTSM-Tutorial-2022/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Day2c_CodeModification.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/NCAR/CTSM-Tutorial-2022/edit/master/docs/notebooks/Day2c_CodeModification.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/NCAR/CTSM-Tutorial-2022/master?urlpath=tree/docs/notebooks/Day2c_CodeModification.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-the-cloned-ctsm-repository">
   1. Check the cloned CTSM repository
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-branch-for-your-code-modifications">
   2. Create a branch for your code modifications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-your-code-modifications">
   3- Make your code modifications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-ctsm-simulation-using-your-modifications">
   4- Run CTSM simulation using your modifications:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-your-changes-to-your-github-branch">
   5- Save your changes to your github branch
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optional-6-sharing-your-changes-with-others-and-pushing-back-your-changes-to-github-repository">
   [Optional] 6- Sharing your changes with others and pushing back your changes to GitHub Repository:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-fork-from-ctsm-repository">
     6-1 : Create a fork from CTSM repository
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     6-2 : Create a fork from CTSM repository
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pushing-your-changes-to-the-outside-world">
     6-3: Pushing your changes to the outside world:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submitting-a-pull-request">
     6-4: Submitting a Pull Request:
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Tutorial 2c - Code Modifications (Workflow + Simulation)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-the-cloned-ctsm-repository">
   1. Check the cloned CTSM repository
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-branch-for-your-code-modifications">
   2. Create a branch for your code modifications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-your-code-modifications">
   3- Make your code modifications
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-ctsm-simulation-using-your-modifications">
   4- Run CTSM simulation using your modifications:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-your-changes-to-your-github-branch">
   5- Save your changes to your github branch
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optional-6-sharing-your-changes-with-others-and-pushing-back-your-changes-to-github-repository">
   [Optional] 6- Sharing your changes with others and pushing back your changes to GitHub Repository:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-fork-from-ctsm-repository">
     6-1 : Create a fork from CTSM repository
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     6-2 : Create a fork from CTSM repository
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pushing-your-changes-to-the-outside-world">
     6-3: Pushing your changes to the outside world:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submitting-a-pull-request">
     6-4: Submitting a Pull Request:
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="tutorial-2c-code-modifications-workflow-simulation">
<h1>Tutorial 2c - <em>Code Modifications (Workflow + Simulation)</em><a class="headerlink" href="#tutorial-2c-code-modifications-workflow-simulation" title="Permalink to this headline">¶</a></h1>
<p>This tutorial is an introduction to familiarizing yourself with <strong>Git</strong> and <strong>Github</strong> workflow and terminology and making simple code modifications. Below, you will find steps to:</p>
<ol class="simple">
<li><p>Check your cloned CTSM repository for any changes to date</p></li>
<li><p>Create a Git branch for code modifications</p></li>
<li><p>Make code modifications</p></li>
<li><p>Run CTSM with new code modifications</p></li>
<li><p>Save changes to your GitHub branch</p></li>
<li><p>[optional] Share your changes with others</p></li>
</ol>
<p>Once you have completed this tutorial, you can compare the changes from the new code to the original in tutorial Day2d_CodeModification_Visualization.</p>
<hr class="docutils" />
<div>
    <img src="https://git-scm.com/images/logos/downloads/Git-Icon-1788C.png" 
         style="float:left; padding-right:10px; width:60px; height:60px;" />
</div>
<strong>Git</strong> is an open-source version control software to track your changes in the source code.
<p><br><br></p>
<div>
    <img src="https://github.com/NCAR/CTSM-Tutorial-2022/raw/main/images/github.png" 
         style="float:left; padding-right:10px; width:60px; height:60px;" />
</div>
<strong>GitHub</strong> provides a centralized online service to host the source code and version control using Git.
<br><br>
<p>If you want to know more about Git and GitHub, here is a tutorial you can use:
<a class="reference external" href="https://swcarpentry.github.io/git-novice/">https://swcarpentry.github.io/git-novice/</a></p>
<div class="alert alert-block alert-info">
<p><b> TIP:</b> Before attempting any code modifications on your own, familiarize yourself with the suggested CTSM workflow with Git that we’ll go over here</p>
</div>
<p>In this tutorial, we assume you have already cloned CTSM repository. If not, please follow the <a class="reference internal" href="Day0a_GitStarted.html"><span class="doc std std-doc">Day0a_GitStarted.ipynb</span></a> to do this.</p>
<p>It is also recommended that you go through the <a class="reference internal" href="Day0b_NEON_Simulation_Tutorial.html"><span class="doc std std-doc">Day0b_NEON_Simulation_Tutorial.ipynb</span></a> tutorial and run simulations for KONZ so that you can compare the results of the code we’ll modify here with the original code.</p>
<div class="section" id="check-the-cloned-ctsm-repository">
<h2>1. Check the cloned CTSM repository<a class="headerlink" href="#check-the-cloned-ctsm-repository" title="Permalink to this headline">¶</a></h2>
<p>First navigate to your cloned CTSM repository:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/CTSM/
</pre></div>
</div>
</div>
</div>
<p>Next, check the status of your clone on the cloud.
The command below shows if you have already made any changes to your code in the cloud:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git status
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>On branch master
Your branch is up to date with &#39;origin/master&#39;.

nothing to commit, working tree clean
</pre></div>
</div>
</div>
</div>
<p>You will likely see this message: “Your branch is up to date with ‘origin/master’.” Note that if you have already made changes to the model code, it will show up as the output of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>.</p>
<p>To check what changes you have made to the code at any point, you can use the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git diff
</pre></div>
</div>
</div>
</div>
<p>If you have been following this tutorial consecutively, you should have a clean copy of the repository and will not see any differences.</p>
</div>
<div class="section" id="create-a-branch-for-your-code-modifications">
<h2>2. Create a branch for your code modifications<a class="headerlink" href="#create-a-branch-for-your-code-modifications" title="Permalink to this headline">¶</a></h2>
<p>Now we want to create a git branch for our code modifications. A branch in GitHub terminology is a way to keep making modifications and developing new features to the codes and not changing the main part of the code. With a branch, we are making another line of development for the code without changing anything in the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, where the original code is located.</p>
<div class="alert alert-block alert-info">
<b>NOTE: </b> 
    A <code>branch</code> of a repository is a copy of the original <code>main</code> branch (similar to branches in a tree). Branches allow you to preserve the main code (the 'main'  branch), make a copy (a new branch) and then work within that new branch.
</div>
<p>Next, let’s create a branch for your development called (<code class="docutils literal notranslate"><span class="pre">phenology_change</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout -b phenology_change
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git status
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<b>NOTE: </b> 
 GitHub branches give us the flexibility to work on the same code base at the same time while keep tracking of who and where things have changed. When playing a video game, we save our progress at checkpoints, so in future we can go back to these points and start from specific part of the game. Similarly, Git and Github give us the flexibility to save snapshots of the code, so we can revert back to these snapshots. The image below shows how different branches might be developed at the same time and merged back with each other.
</div>
<p><img alt="github" src="https://nvie.com/img/main-branches&#64;2x.png" /></p>
</div>
<div class="section" id="make-your-code-modifications">
<h2>3- Make your code modifications<a class="headerlink" href="#make-your-code-modifications" title="Permalink to this headline">¶</a></h2>
<p>Now that you have a<code class="docutils literal notranslate"><span class="pre">branch</span></code> of the code, you can start changing the code.</p>
<p>In this tutorial, we are going to change the rain threshhold for leaf onset and compare the results for Konza Prairie Biological Station (KONZ).</p>
<div class="alert alert-block alert-warning">
<p><b> WARNING: </b> If you are interested in comparing the results from modified code with original code, you should make sure you have already run the original CTSM code base for your tower of interest (e.g. KONZ).</p>
</div>
<p>To find more information about KONZ site, please NEON’s website: <a class="reference external" href="https://www.neonscience.org/field-sites/konz">https://www.neonscience.org/field-sites/konz</a></p>
<p><strong>Quesions:</strong></p>
<ul class="simple">
<li><p>Where is Konza Prairie Biological Station located?</p></li>
<li><p>What kind of behavior do we expect by changing the rain threshhold for leaf onset in this site?</p></li>
</ul>
<p>The codes of CTSM model are located under <code class="docutils literal notranslate"><span class="pre">src</span></code> directory.</p>
<p>You can navigate to <code class="docutils literal notranslate"><span class="pre">src</span></code> directory and check the content of it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/CTSM/src
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls 
</pre></div>
</div>
</div>
</div>
<p>As you can see there are multiple directories and multiple files listed in this directory.</p>
<div class="alert alert-success">
  <strong>Fun Fact:</strong> There is roughly ~252,919 lines of Fortran code in CTSM repository. 
</div><p>In this example, we are making these code modifications in <code class="docutils literal notranslate"><span class="pre">src/biogeochem/CNPhenologyMod.F90</span></code>.</p>
<p>First, let’s navigate to this directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/CTSM/src/biogeochem
<span class="nb">pwd</span>
</pre></div>
</div>
</div>
</div>
<p>List all the files in this directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
</pre></div>
</div>
</div>
</div>
<p>Here we are modifying <code class="docutils literal notranslate"><span class="pre">rain_threshold</span></code> in <code class="docutils literal notranslate"><span class="pre">~/CTSM/src/biogeochem/CNPhenologyMod.F90</span></code>.</p>
<p>From your side bar open up the files you’d like to modify by double clicking on the file.</p>
<div class="alert alert-info">
<p><b>TIP:</b>  You can do this with any text editor. You can either use a terminal to open up <code>vim</code> or <code>emacs</code>, or you can do the following using JupyterLab sidebar:</p>
</div>
<p>Navigate to <code class="docutils literal notranslate"><span class="pre">CTSM/src/biogeochem/CNPhenologyMod.F90</span></code> and open up the <code class="docutils literal notranslate"><span class="pre">CNPhenologyMod.F90</span></code> file by double clicking on the file:</p>
<p><img alt="image1.png" src="https://github.com/NCAR/CTSM-Tutorial-2022/raw/main/images/file_listing_1.png" /></p>
<p>It will open up the file under another tab:</p>
<p><img alt="image2.png" src="https://github.com/NCAR/CTSM-Tutorial-2022/raw/main/images/file_listing_2.png" /></p>
<p>This will open up a Fortran code, which you can read and edit.</p>
<p><strong>Question:</strong></p>
<ul class="simple">
<li><p>Can you find what is the current value of <code class="docutils literal notranslate"><span class="pre">rain_threshhold</span></code>? You can look through the code to find this value.</p></li>
</ul>
<p><strong>Answer:</strong></p>
<p>The current value of <code class="docutils literal notranslate"><span class="pre">rain_threshold</span></code> is 20mm as specified in the line 1349 in the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rain_threshold</span> <span class="o">=</span> <span class="mf">20.</span><span class="n">_r8</span> 
</pre></div>
</div>
<hr class="docutils" />
<p>Now you can change the <code class="docutils literal notranslate"><span class="pre">rain_threshhold</span></code> to a lower or a higher value.</p>
<p>For example:  the following modification will set the rain threshhold for leaf onset to 1mm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rain_threshold</span> <span class="o">=</span> <span class="mf">1.</span><span class="n">_r8</span> 

</pre></div>
</div>
<p>Now, <strong>close and save</strong> this file and navigate back to your notebook. Make sure to save before closing the file.</p>
<p><strong>Question:</strong></p>
<ul class="simple">
<li><p>How do you think changing this value will impact your simulations?</p></li>
</ul>
<hr class="docutils" />
<p>Let’s quickly check that our code modes are reflected using git</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git diff ~/CTSM/src/biogeochem/CNPhenologyMod.F90
</pre></div>
</div>
</div>
</div>
<p>You should see that changes you made to <code class="docutils literal notranslate"><span class="pre">rain_threshold</span></code> reflected above.</p>
</div>
<div class="section" id="run-ctsm-simulation-using-your-modifications">
<h2>4- Run CTSM simulation using your modifications:<a class="headerlink" href="#run-ctsm-simulation-using-your-modifications" title="Permalink to this headline">¶</a></h2>
<p>In this step, you will test your modifications by running your own code.</p>
<p>You can do so by either:</p>
<ol class="simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">./run_neon.py</span></code> script. (easiest method)</p></li>
<li><p>Following the steps for running an unsuported single point case similar to <a class="reference internal" href="Day2a_GenericSinglePoint.html"><span class="doc std std-doc">Day2a_GenericSinglePoint.ipynb</span></a>.</p></li>
</ol>
<div class="alert alert-info">
  <strong> Reminder: </strong> <code> ./run_neon.py </code> is basically a user-friendly script that simplifies all the steps of running neon cases into one command.
</div>
<p>Now, let’s run CTSM simulation for our NEON site (e.g. KONZ) with these modifications. We are saving the output of this simulations in <code class="docutils literal notranslate"><span class="pre">~/scratch/CLM-NEON-phenologychange</span></code>. Creating a new output-root like this will allow us to test the changes at several sites.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>qcmd -- run_neon --neon-sites KONZ --output-root ~/scratch/CLM-NEON-phenologychange --overwrite
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
<p><b>WARNING!</b></p>
<p>You should really do a full spinup after making code modifications.  But for this examples we’re just going to have a quick look at changes in LAI and GPP that results from our phenology changes. This is a quick way to make sure the changes worked as intended BEFORE running an AD and post-AD spinup to generate a new initial conditions file.</p>
</div></div>
<div class="section" id="save-your-changes-to-your-github-branch">
<h2>5- Save your changes to your github branch<a class="headerlink" href="#save-your-changes-to-your-github-branch" title="Permalink to this headline">¶</a></h2>
<p>When you are happy with your changes, you should make sure you have commited these changes and submitted them to your GitHub repository.</p>
<p>Easiest way to do so:</p>
<p>First run the following to find all the files that has been modified. You should see all the modified files here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git status
</pre></div>
</div>
</div>
</div>
<p>Next add these file (or all files) to be saved:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git add . 
</pre></div>
</div>
</div>
</div>
<p>Next commit your changes using a meaningful commit message:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git commit -m <span class="s2">&quot;Changing rain threshhold for leaf onset to 1mm&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>You can check your branch vs. the main branch to see the changes the submitted changes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git diff phenology_change origin/main
</pre></div>
</div>
</div>
</div>
<div class="alert alert-success">
  <strong>Congratulations!</strong> Now you have successfully chande the rain threshhold for leaf onset and run the simulations for it. For visualizing the results, please check the next tutorial. 
</div>
<p>Next, you can visualize the output of original simulation vs the modified code for KONZ site and compare it with evaluation files.</p>
<p>In the next tutorial, we are going to work on visualizing the results of the modified code.</p>
<p><strong>Go To <a class="reference internal" href="Day2d_CodeModification_Visualization.html"><span class="doc std std-doc">Day2d_CodeModification_Visualization.ipynb</span></a></strong></p>
</div>
<div class="section" id="optional-6-sharing-your-changes-with-others-and-pushing-back-your-changes-to-github-repository">
<h2>[Optional] 6- Sharing your changes with others and pushing back your changes to GitHub Repository:<a class="headerlink" href="#optional-6-sharing-your-changes-with-others-and-pushing-back-your-changes-to-github-repository" title="Permalink to this headline">¶</a></h2>
<p>So far, we have made some changes and saved it a <code class="docutils literal notranslate"><span class="pre">local</span></code> branch; however, in real-life we usually want/need to push our changes back to GitHub so our collaborators can see and comment on our code or use our codes.
Imagine saving your progress in a video game on a local computer, if you use another computer you can not load your progress in another computer. However, if you save your video game progress on a cloud, you can easily access it anywhere. Nowadays, video games save your progress via a profile/account.</p>
<p>Similarly, <strong>you need to create an account on GitHub to be able to push back your changes</strong> so:</p>
<ul class="simple">
<li><p>you can access it from anywhere.</p></li>
<li><p>you can share it with collaborators.</p></li>
<li><p>you can contribute back to CTSM repository.</p></li>
</ul>
<div class="section" id="create-a-fork-from-ctsm-repository">
<h3>6-1 : Create a fork from CTSM repository<a class="headerlink" href="#create-a-fork-from-ctsm-repository" title="Permalink to this headline">¶</a></h3>
<p>First, you need to create an account on <span class="xref myst">GitHub</span>, if you don’t already have an account there. Skip this if you already have an account on GitHub.</p>
</div>
<div class="section" id="id1">
<h3>6-2 : Create a fork from CTSM repository<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>For saving your progress via GitHub you need to create your own fork of the CTSM repository.You probably don’t have access to write directly to the main CTSM repository (that right is reserved for the CTSM main software engineers). Therefore, you need your own copy of the repository to push your changes to:</p>
<div class="alert alert-info">
  <strong> NOTE: </strong> 
    A fork is a copy of a repository. "Fork"ing a repository allows you to freely experiment with changes without affecting the original project. A normal user will not have the access to write to the CTSM original repository. Therefore, you need to create your own repository by creating your own fork of the original repository to push your changes.
</div>
<p>You can create your own fork of the CTSM repository by using the fork button in the upper right corner of the CTSM reository page.</p>
<ul class="simple">
<li><p>Login to your GitHub account.</p></li>
<li><p>Navigate to the original <a class="reference external" href="https://github.com/ESCOMP/CTSM">CTSM repository</a> (escomp/CTSM).</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">fork</span></code> button to create a fork of CTSM repository in your accoun</p></li>
</ul>
<p><img alt="image3.png" src="https://github.com/NCAR/CTSM-Tutorial-2022/raw/main/images/fork_image.png" /></p>
<p>Your forked repository will be under your account name:</p>
<p><a class="reference external" href="https://github.com/YOUR-USER-NAME/CTSM">https://github.com/YOUR-USER-NAME/CTSM</a></p>
<p>For example, for the username (negin513) the forked repo is:</p>
<p><a class="reference external" href="https://github.com/negin513/CTSM">https://github.com/negin513/CTSM</a></p>
<p>You can make any modifications you’d like to your forked repository.</p>
</div>
<div class="section" id="pushing-your-changes-to-the-outside-world">
<h3>6-3: Pushing your changes to the outside world:<a class="headerlink" href="#pushing-your-changes-to-the-outside-world" title="Permalink to this headline">¶</a></h3>
<p>Now you have to connect your forked repository to this machine. You can do so by using the following:</p>
<div class="alert alert-block alert-danger">
<p><b>WARNING!</b></p>
<p>Please replace “YOUR_USER_NAME” with your own GitHub username that you create in step 6-0 for the code below.</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git remote add YOUR_USER_NAME git@github.com:YOUR_USER_NAME/CTSM.git
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Finally push your changes to the remote repository:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git push -u YOUR_USER_NAME phenology_change
</pre></div>
</div>
</div>
</div>
<p>To see your changes now you can go to your own fork and your own branch on <span class="xref myst">github.com</span> and see your recent changes.</p>
</div>
<div class="section" id="submitting-a-pull-request">
<h3>6-4: Submitting a Pull Request:<a class="headerlink" href="#submitting-a-pull-request" title="Permalink to this headline">¶</a></h3>
<p>In future, you might want to get your changes back to CTSM main branch, you will need to submit a GitHub Pull Request.</p>
<p>Creating a Pull Request (PR) is easy and is a great way to contribute scientific changes to the community code.
To create a PR:</p>
<ul class="simple">
<li><p>Navigate to CTSM PR page on GitHub (<a class="reference external" href="https://github.com/ESCOMP/CTSM/pulls">https://github.com/ESCOMP/CTSM/pulls</a>)</p></li>
<li><p>Next, click the <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">pull</span> <span class="pre">request</span></code> button on the top right corner of the page.</p></li>
<li><p>Next, click on <code class="docutils literal notranslate"><span class="pre">compare</span> <span class="pre">accross</span> <span class="pre">forks</span></code>.</p></li>
<li><p>Choose your base and head repository and branches.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">head</span> <span class="pre">repository</span></code> choose your own fork.</p></li>
<li><p>Next, click on <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">pull</span> <span class="pre">request</span></code> green button.</p></li>
<li><p>In the “Open a pull request” page, confirm the forks and branches being used for the pull request. On the left you should see “base fork: ESCOMP/CTSM” and “base: master”. On the right you should see “head fork: YOUR_USER_NAME/CTSM” and “compare: MYBRANCH” (where YOUR_USER_NAME will be your git username, and MYBRANCH will be the branch you’d like brought to master).</p></li>
<li><p>Enter a short but descriptive title for this pull request</p></li>
<li><p>In the comment box, give a more detailed description of this pull request</p></li>
<li><p>Click the green “Create pull request” button</p></li>
</ul>
<p>Our scientists and software engineers can review the code and merge it CTSM main branch.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "bash"
        },
        kernelOptions: {
            kernelName: "bash",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'bash'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Day2b_GenericSinglePoint_Visualization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Tutorial 2b: <em>Single-Point Visualizations</em></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Day2d_CodeModification_Visualization.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial 2d - <em>Code Modifications (Visualization)</em></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Negin Sobhani, Danica Lombardozzi, Adrianna Foster, Will Wieder<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>